import{j as a,c as W,B as It,R as b,A as F,r as V}from"./index-jJ-r5mz2.js";import{S as zt}from"./search-context-Dy6rVJYC.js";import{H as Lt,S as Mt,T as Dt,P as Ft,M as Bt}from"./theme-switch-Co7n-EGK.js";import{C as Kt,b as Wt,c as Vt,a as Gt}from"./card-BJCnjeSF.js";import{S as Ge}from"./shield-B1QauJ3X.js";import{C as Ht}from"./circle-alert-CnzQp5Ap.js";import{S as Se,T as ct,a as lt,b as ae,c as oe,B as qt}from"./tabs-CiAJZDg-.js";import{c as E}from"./index-DSZ_lwlW.js";import{B as pe}from"./badge-B4wrcvZ9.js";import{C as Qt}from"./chevron-right-D5wS3klw.js";import{T as He}from"./target-DSK53Fwg.js";import{B as Xt,i as z,C as Ut,T as ut,f as M,p as Te,a as Z,L as G,g as X,b as dt,S as Yt,A as Zt,c as Ce,d as qe,e as Jt,h as P,j as ft,k as er,u as tr,G as ht,m as se,l as rr,n as mt,o as ir,q as de,w as ve,r as nr,s as Ae,t as Oe,v as Me,x as De,y as ar,z as or,D as sr,E as pt,F as _e,H as cr,I as lr,J as vt,K as yt,M as ur,P as dr,N as fr,O as hr,R as Qe,Q as Xe}from"./generateCategoricalChart-DcMkBhwW.js";import{a as mr,A as pr}from"./arrow-right-DC79kPTr.js";import{S as vr,D as yr}from"./server-C90NfND0.js";import{f as xr}from"./format-Dp3w_Y3x.js";/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]],Ue=E("book-text",gr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Ye=E("chart-column",br);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ze=E("circle-question-mark",jr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]],wr=E("code-xml",_r);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m2.305 15.53.923-.382",key:"yfp9st"}],["path",{d:"m3.228 12.852-.924-.383",key:"bckynb"}],["path",{d:"M4.677 21.5a2 2 0 0 0 1.313.5H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v2.5",key:"1yo3oz"}],["path",{d:"m4.852 11.228-.383-.923",key:"1j88i9"}],["path",{d:"m4.852 16.772-.383.924",key:"sag1dv"}],["path",{d:"m7.148 11.228.383-.923",key:"rj39hk"}],["path",{d:"m7.53 17.696-.382-.924",key:"1uu5cs"}],["path",{d:"m8.772 12.852.923-.383",key:"13811l"}],["path",{d:"m8.772 15.148.923.383",key:"z1a5l0"}],["circle",{cx:"6",cy:"14",r:"3",key:"a1xfv6"}]],Ar=E("file-cog",kr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],Nr=E("fingerprint",Or);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pr=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],Je=E("git-merge",Pr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]],Tr=E("life-buoy",Sr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],xt=E("list-checks",Cr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],$r=E("list-todo",Er);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]],Ir=E("microscope",Rr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ce=E("shield-check",zr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]],Mr=E("shield-plus",Lr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]],Fr=E("shield-x",Dr);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kr=E("square-check-big",Br);/**
 * @license lucide-react v0.523.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],et=E("wrench",Wr);function C({title:e,icon:t,children:i,className:r,titleClassName:n}){return a.jsxs(Kt,{className:W("overflow-hidden shadow-sm",r),children:[a.jsxs(Wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2 bg-muted/20 border-b",children:[a.jsx(Vt,{className:W("text-lg font-semibold",n),children:e}),t&&a.jsx(t,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(Gt,{className:"pt-6",children:i})]})}function gt({text:e,className:t}){return a.jsx("span",{className:W("inline-block rounded-full px-3 py-1 text-xs font-semibold",t),children:e})}function Vr(e){switch(e?.toLowerCase()){case"严重":return"bg-red-500 text-white";case"高":return"bg-orange-500 text-white";case"中":return"bg-yellow-400 text-black";case"低":return"bg-green-500 text-white";default:return"bg-gray-400 text-white"}}function Gr(e){switch(e){case"非常有效":return"text-green-500";case"有效":return"text-blue-500";case"一般":return"text-yellow-500";case"无效":return"text-red-500";default:return"text-gray-500"}}function Hr(e){switch(e){case"非常有效":return a.jsx(ce,{className:"h-10 w-10"});case"有效":return a.jsx(Ge,{className:"h-10 w-10"});case"一般":return a.jsx(Se,{className:"h-10 w-10"});case"无效":return a.jsx(Ht,{className:"h-10 w-10"});default:return a.jsx(Ge,{className:"h-10 w-10"})}}function qr({data:e}){return!e||typeof e=="string"?a.jsx(C,{title:"攻击链分析",icon:Je,children:a.jsx("p",{className:"text-muted-foreground",children:"攻击链分析信息不可用。"})}):a.jsx(C,{title:"攻击链分析",icon:Je,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-md mb-3 flex items-center gap-2",children:[a.jsx(Nr,{className:"h-5 w-5 text-primary"}),"攻击路径 (MITRE ATT&CK®)"]}),a.jsx("div",{className:"flex flex-wrap items-center gap-2 text-sm text-muted-foreground",children:e.attack_stages?.map((t,i)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pe,{variant:"secondary",children:t}),i<e.attack_stages.length-1&&a.jsx(Qt,{className:"h-4 w-4"})]},i))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-md mb-3 flex items-center gap-2",children:"攻击技术"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:e.attack_techniques?.map(t=>a.jsx(pe,{variant:"outline",children:t},t))})]})]})})}function Qr({data:e}){if(!e||typeof e=="string")return a.jsx(C,{title:"溯源结论摘要",icon:He,children:a.jsx("p",{className:"text-muted-foreground",children:"溯源结论摘要信息不可用。"})});const t=i=>{switch(i.toLowerCase()){case"高":return"bg-green-500 text-white";case"中等":return"bg-yellow-400 text-black";case"低":return"bg-orange-500 text-white";default:return"bg-gray-400 text-white"}};return a.jsx(C,{title:"溯源结论摘要",icon:He,children:a.jsxs("div",{className:"space-y-4 text-sm",children:[a.jsx(fe,{icon:Xt,title:"攻击者归属",children:a.jsx("p",{children:e.attacker_attribution})}),a.jsx(fe,{icon:Ze,title:"攻击动机",children:a.jsx("p",{children:e.attack_motivation})}),a.jsx(fe,{icon:mr,title:"攻击影响",children:a.jsx("p",{children:e.attack_impact})}),a.jsx(fe,{icon:Ze,title:"溯源置信度",children:a.jsx(gt,{text:e.attribution_confidence||"未知",className:t(e.attribution_confidence||"")})}),a.jsxs("div",{className:"pt-2",children:[a.jsx("h5",{className:"font-semibold mb-2 flex items-center gap-2",children:"推理过程"}),a.jsx("blockquote",{className:"border-l-2 pl-4 italic text-muted-foreground",children:e.attribution_reasoning})]})]})})}function fe({icon:e,title:t,children:i}){return a.jsxs("div",{className:"flex items-start",children:[a.jsxs("div",{className:"flex items-center gap-2 w-1/3 font-semibold",children:[a.jsx(e,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:t})]}),a.jsx("div",{className:"w-2/3 text-muted-foreground",children:i})]})}function Xr({data:e}){return!e||typeof e=="string"?a.jsx(C,{title:"执行摘要",icon:Ue,children:a.jsx("p",{className:"text-muted-foreground",children:"摘要信息不可用。"})}):a.jsx(C,{title:"执行摘要",icon:Ue,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-base leading-relaxed",children:e.threat_overview}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-md mb-2 flex items-center gap-2",children:[a.jsx(Kr,{className:"h-5 w-5 text-primary"}),"主要发现"]}),a.jsx("ul",{className:"space-y-2 pl-6 list-disc marker:text-primary",children:e.main_findings?.map((t,i)=>a.jsx("li",{className:"text-muted-foreground",children:t},i))})]})]})})}function Ur({emergencyPlan:e,recommendations:t,nextSteps:i}){const r=e&&typeof e!="string"?e:null,n=t&&typeof t!="string"?t:null,o=i&&typeof i!="string"?i:null;return a.jsx(C,{title:"建议与后续行动",icon:Tr,children:a.jsxs(ct,{defaultValue:"emergency-plan",children:[a.jsxs(lt,{className:"grid w-full grid-cols-1 sm:grid-cols-3",children:[a.jsxs(ae,{value:"emergency-plan",children:[a.jsx($r,{className:"h-4 w-4 mr-2"}),"应急响应预案"]}),a.jsxs(ae,{value:"recommendations",children:[a.jsx(Mr,{className:"h-4 w-4 mr-2"}),"安全改进建议"]}),a.jsxs(ae,{value:"next-steps",children:[a.jsx(pr,{className:"h-4 w-4 mr-2"}),"后续步骤"]})]}),a.jsx(oe,{value:"emergency-plan",className:"pt-6",children:r?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx(ne,{title:"立即行动",items:r.immediate_actions}),a.jsx(ne,{title:"短期措施",items:r.short_term_measures}),a.jsx(ne,{title:"长期改进",items:r.long_term_improvements,className:"md:col-span-2"}),a.jsx(ne,{title:"人员分工",items:r.personnel_assignments}),a.jsx(ne,{title:"沟通机制",items:r.communication_mechanisms})]}):a.jsx("p",{children:"信息不可用。"})}),a.jsx(oe,{value:"recommendations",className:"pt-6",children:n?a.jsx("div",{className:"space-y-3",children:n.recommendations.map((s,l)=>a.jsx(Yr,{text:s},l))}):a.jsx("p",{children:"信息不可用。"})}),a.jsx(oe,{value:"next-steps",className:"pt-6",children:o?a.jsx("ul",{className:"space-y-2 pl-6 list-decimal marker:text-primary",children:o.steps.map((s,l)=>a.jsx("li",{className:"text-muted-foreground",children:s},l))}):a.jsx("p",{children:"信息不可用。"})})]})})}function ne({title:e,items:t,className:i}){return a.jsxs("div",{className:i,children:[a.jsx("h5",{className:"font-semibold mb-2",children:e}),a.jsx("ul",{className:"space-y-2 pl-4 list-disc marker:text-primary/50",children:t.map((r,n)=>a.jsx("li",{className:"text-muted-foreground text-sm",children:r},n))})]})}function Yr({text:e}){const i=(n=>n.includes("高优先级")?{label:"高",color:"bg-red-500"}:n.includes("中优先级")?{label:"中",color:"bg-orange-500"}:n.includes("低优先级")?{label:"低",color:"bg-yellow-500"}:{label:"信息",color:"bg-blue-500"})(e),r=e.replace(/\*\*(高|中|低)优先级\*\*:\s*/,"");return a.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[a.jsx(pe,{className:`${i.color} text-white`,children:i.label}),a.jsx("p",{className:"text-muted-foreground text-sm flex-1",children:r})]})}function Zr({data:e}){return!e||typeof e=="string"?a.jsx(C,{title:"漏洞修复分析",icon:et,children:a.jsx("p",{className:"text-muted-foreground",children:"修复分析信息不可用。"})}):a.jsx(C,{title:"漏洞修复分析",icon:et,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center bg-muted/20 p-3 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ce,{className:"h-5 w-5 text-green-500"}),a.jsx("span",{className:"font-semibold",children:"修复成功率"})]}),a.jsx(pe,{className:"bg-green-500 text-white",children:e.remediation_success_rate})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(he,{icon:xt,title:"修复动作",items:e.remediation_actions}),a.jsx(he,{icon:vr,title:"重启的服务",items:e.restarted_services}),a.jsx(he,{icon:Ar,title:"Web配置修改",items:e.web_config_changes}),a.jsx(he,{icon:ce,title:"应用的补丁",items:e.applied_patches})]})]})})}function he({title:e,items:t,icon:i}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("h5",{className:"font-semibold flex items-center gap-2 text-sm",children:[a.jsx(i,{className:"h-4 w-4"})," ",e]}),a.jsxs("div",{className:"p-2 border rounded-lg bg-muted/20 space-y-1",children:[t.map((r,n)=>a.jsx("p",{className:"text-muted-foreground text-xs",children:r},n)),t.length===0&&a.jsx("p",{className:"text-muted-foreground text-xs italic",children:"无"})]})]})}function Jr({modelId:e,timestamp:t,reportFile:i}){return a.jsxs("header",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 py-4 border-b-2 border-primary",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-3xl font-bold text-primary flex items-center gap-2",children:[a.jsx(qt,{className:"h-8 w-8"}),a.jsx("span",{children:"Agent 演练报告"})]}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["为您生成关于"," ",a.jsx("span",{className:"font-semibold text-foreground",children:e})," ","的详细安全分析。"]})]}),a.jsxs("div",{className:"flex flex-col sm:items-end gap-2 text-sm",children:[a.jsxs(It,{size:"sm",variant:"outline",children:[a.jsx(yr,{className:"h-4 w-4 mr-2"}),"下载报告 (",i,")"]}),a.jsxs("p",{className:"text-muted-foreground",children:["报告生成于: ",xr(new Date(t),"yyyy-MM-dd HH:mm:ss")]})]})]})}function ei({data:e}){if(!e||typeof e=="string")return a.jsx(C,{title:"响应效果评估",icon:ce,children:a.jsx("p",{className:"text-muted-foreground",children:"响应效果评估信息不可用。"})});const t=Gr(e.effectiveness),i=Hr(e.effectiveness);return a.jsx(C,{title:"响应效果评估",icon:ce,className:W("border-l-4",t.replace("text-","border-")),titleClassName:t,children:a.jsxs("div",{className:"flex flex-col items-center text-center space-y-4",children:[a.jsx("div",{className:W("h-16 w-16 flex items-center justify-center rounded-full",t.replace("text-","bg-")+"_10"),children:a.jsx("div",{className:W(t),children:i})}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:W("text-2xl font-bold",t),children:e.effectiveness}),a.jsx("p",{className:"text-muted-foreground text-sm",children:e.details})]})]})})}function ti({data:e}){if(!e||typeof e=="string")return a.jsx(C,{title:"风险评估",icon:Se,children:a.jsx("p",{className:"text-muted-foreground",children:"风险评估信息不可用。"})});const t=Vr(e.risk_level);return a.jsx(C,{title:"风险评估",icon:Se,className:"border-l-4 border-orange-500",titleClassName:"text-orange-500",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"font-semibold",children:"风险等级"}),a.jsx(gt,{text:e.risk_level||"未知",className:W(t)})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"详情"}),a.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:e.details})]})]})})}function ri({attackTypes:e,threatBlocking:t}){const i=e&&typeof e!="string"?e:{},r=t&&typeof t!="string"?t:null;return a.jsx(C,{title:"威胁与阻断分析",icon:Ir,children:a.jsxs(ct,{defaultValue:"attack-types",children:[a.jsxs(lt,{className:"grid w-full grid-cols-2",children:[a.jsxs(ae,{value:"attack-types",children:[a.jsx(wr,{className:"h-4 w-4 mr-2"}),"攻击类型分析"]}),a.jsxs(ae,{value:"threat-blocking",children:[a.jsx(Fr,{className:"h-4 w-4 mr-2"}),"威胁阻断分析"]})]}),a.jsx(oe,{value:"attack-types",className:"pt-4",children:a.jsx("div",{className:"space-y-4",children:Object.entries(i).map(([n,o])=>a.jsxs("div",{className:"p-4 border rounded-lg bg-muted/20",children:[a.jsx("h5",{className:"font-semibold mb-2",children:n}),a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:o.description}),a.jsx("h6",{className:"text-xs font-semibold mb-2",children:"示例:"}),a.jsx("div",{className:"space-y-2",children:o.examples.map((s,l)=>a.jsx("code",{className:"block text-xs bg-black text-white p-2 rounded",children:s},l))})]},n))})}),a.jsx(oe,{value:"threat-blocking",className:"pt-4",children:r?a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsx(Ne,{title:"阻断的IP",items:r.blocked_ips}),a.jsx(Ne,{title:"阻断的端口",items:r.blocked_ports}),a.jsx(Ne,{title:"生效的防火墙规则",items:r.firewall_rules,className:"md:col-span-2"}),a.jsxs("div",{className:"p-4 border rounded-lg bg-muted/20 md:col-span-2",children:[a.jsx("h5",{className:"font-semibold mb-2",children:"阻断效果评估"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:r.blocking_effectiveness})]})]}):a.jsx("p",{className:"text-muted-foreground",children:"威胁阻断信息不可用。"})})]})})}function Ne({title:e,items:t,className:i}){return a.jsxs("div",{className:i,children:[a.jsxs("h5",{className:"font-semibold mb-2 flex items-center gap-2",children:[a.jsx(xt,{className:"h-4 w-4"}),e]}),a.jsx("div",{className:"p-2 border rounded-lg bg-muted/20 space-y-1",children:t.map((r,n)=>a.jsx("p",{className:"text-muted-foreground font-mono text-xs",children:r},n))})]})}var me;function J(e){"@babel/helpers - typeof";return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},J(e)}function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},U.apply(this,arguments)}function tt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function k(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?tt(Object(i),!0).forEach(function(r){L(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tt(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,jt(r.key),r)}}function ni(e,t,i){return t&&rt(e.prototype,t),i&&rt(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function ai(e,t,i){return t=ye(t),oi(e,bt()?Reflect.construct(t,i||[],ye(e).constructor):t.apply(e,i))}function oi(e,t){if(t&&(J(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return si(e)}function si(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bt=function(){return!!e})()}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ye(e)}function ci(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ee(e,t)}function Ee(e,t){return Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ee(e,t)}function L(e,t,i){return t=jt(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function jt(e){var t=li(e,"string");return J(t)=="symbol"?t:t+""}function li(e,t){if(J(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(J(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var B=function(e){function t(i){var r;return ii(this,t),r=ai(this,t,[i]),L(r,"pieRef",null),L(r,"sectorRefs",[]),L(r,"id",tr("recharts-pie-")),L(r,"handleAnimationEnd",function(){var n=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),z(n)&&n()}),L(r,"handleAnimationStart",function(){var n=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),z(n)&&n()}),r.state={isAnimationFinished:!i.isAnimationActive,prevIsAnimationActive:i.isAnimationActive,prevAnimationId:i.animationId,sectorToFocus:0},r}return ci(t,e),ni(t,[{key:"isActiveIndex",value:function(r){var n=this.props.activeIndex;return Array.isArray(n)?n.indexOf(r)!==-1:r===n}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.label,l=o.labelLine,u=o.dataKey,d=o.valueKey,c=M(this.props,!1),v=M(s,!1),h=M(l,!1),f=s&&s.offsetRadius||20,y=r.map(function(m,p){var j=(m.startAngle+m.endAngle)/2,g=Te(m.cx,m.cy,m.outerRadius+f,j),x=k(k(k(k({},c),m),{},{stroke:"none"},v),{},{index:p,textAnchor:t.getTextAnchor(g.x,m.cx)},g),_=k(k(k(k({},c),m),{},{fill:"none",stroke:m.fill},h),{},{index:p,points:[Te(m.cx,m.cy,m.outerRadius,j),g]}),w=u;return Z(u)&&Z(d)?w="value":Z(u)&&(w=d),b.createElement(G,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(p)},l&&t.renderLabelLineItem(l,_,"line"),t.renderLabelItem(s,x,X(m,w)))});return b.createElement(G,{className:"recharts-pie-labels"},y)}},{key:"renderSectorsStatically",value:function(r){var n=this,o=this.props,s=o.activeShape,l=o.blendStroke,u=o.inactiveShape;return r.map(function(d,c){if(d?.startAngle===0&&d?.endAngle===0&&r.length!==1)return null;var v=n.isActiveIndex(c),h=u&&n.hasActiveIndex()?u:null,f=v?s:h,y=k(k({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return b.createElement(G,U({ref:function(p){p&&!n.sectorRefs.includes(p)&&n.sectorRefs.push(p)},tabIndex:-1,className:"recharts-pie-sector"},dt(n.props,d,c),{key:"sector-".concat(d?.startAngle,"-").concat(d?.endAngle,"-").concat(d.midAngle,"-").concat(c)}),b.createElement(Yt,U({option:f,isActive:v,shapeType:"sector"},y)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,n=this.props,o=n.sectors,s=n.isAnimationActive,l=n.animationBegin,u=n.animationDuration,d=n.animationEasing,c=n.animationId,v=this.state,h=v.prevSectors,f=v.prevIsAnimationActive;return b.createElement(Zt,{begin:l,duration:u,isActive:s,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(c,"-").concat(f),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(y){var m=y.t,p=[],j=o&&o[0],g=j.startAngle;return o.forEach(function(x,_){var w=h&&h[_],A=_>0?Ce(x,"paddingAngle",0):0;if(w){var $=qe(w.endAngle-w.startAngle,x.endAngle-x.startAngle),O=k(k({},x),{},{startAngle:g+A,endAngle:g+$(m)+A});p.push(O),g=O.endAngle}else{var R=x.endAngle,I=x.startAngle,D=qe(0,R-I),ue=D(m),K=k(k({},x),{},{startAngle:g+A,endAngle:g+ue+A});p.push(K),g=K.endAngle}}),b.createElement(G,null,r.renderSectorsStatically(p))})}},{key:"attachKeyboardHandlers",value:function(r){var n=this;r.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var s=++n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[s].focus(),n.setState({sectorToFocus:s});break}case"ArrowRight":{var l=--n.state.sectorToFocus<0?n.sectorRefs.length-1:n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[l].focus(),n.setState({sectorToFocus:l});break}case"Escape":{n.sectorRefs[n.state.sectorToFocus].blur(),n.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,n=r.sectors,o=r.isAnimationActive,s=this.state.prevSectors;return o&&n&&n.length&&(!s||!Jt(s,n))?this.renderSectorsWithAnimation():this.renderSectorsStatically(n)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,n=this.props,o=n.hide,s=n.sectors,l=n.className,u=n.label,d=n.cx,c=n.cy,v=n.innerRadius,h=n.outerRadius,f=n.isAnimationActive,y=this.state.isAnimationFinished;if(o||!s||!s.length||!P(d)||!P(c)||!P(v)||!P(h))return null;var m=F("recharts-pie",l);return b.createElement(G,{tabIndex:this.props.rootTabIndex,className:m,ref:function(j){r.pieRef=j}},this.renderSectors(),u&&this.renderLabels(s),ft.renderCallByParent(this.props,null,!1),(!f||y)&&er.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return n.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:n.curSectors,isAnimationFinished:!0}:r.sectors!==n.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,n){return r>n?"start":r<n?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,n,o){if(b.isValidElement(r))return b.cloneElement(r,n);if(z(r))return r(n);var s=F("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return b.createElement(Ut,U({},n,{key:o,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(r,n,o){if(b.isValidElement(r))return b.cloneElement(r,n);var s=o;if(z(r)&&(s=r(n),b.isValidElement(s)))return s;var l=F("recharts-pie-label-text",typeof r!="boolean"&&!z(r)?r.className:"");return b.createElement(ut,U({},n,{alignmentBaseline:"middle",className:l}),s)}}])}(V.PureComponent);me=B;L(B,"displayName","Pie");L(B,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!ht.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});L(B,"parseDeltaAngle",function(e,t){var i=se(t-e),r=Math.min(Math.abs(t-e),360);return i*r});L(B,"getRealPieData",function(e){var t=e.data,i=e.children,r=M(e,!1),n=rr(i,mt);return t&&t.length?t.map(function(o,s){return k(k(k({payload:o},r),o),n&&n[s]&&n[s].props)}):n&&n.length?n.map(function(o){return k(k({},r),o.props)}):[]});L(B,"parseCoordinateOfPie",function(e,t){var i=t.top,r=t.left,n=t.width,o=t.height,s=ir(n,o),l=r+de(e.cx,n,n/2),u=i+de(e.cy,o,o/2),d=de(e.innerRadius,s,0),c=de(e.outerRadius,s,s*.8),v=e.maxRadius||Math.sqrt(n*n+o*o)/2;return{cx:l,cy:u,innerRadius:d,outerRadius:c,maxRadius:v}});L(B,"getComposedData",function(e){var t=e.item,i=e.offset,r=t.type.defaultProps!==void 0?k(k({},t.type.defaultProps),t.props):t.props,n=me.getRealPieData(r);if(!n||!n.length)return null;var o=r.cornerRadius,s=r.startAngle,l=r.endAngle,u=r.paddingAngle,d=r.dataKey,c=r.nameKey,v=r.valueKey,h=r.tooltipType,f=Math.abs(r.minAngle),y=me.parseCoordinateOfPie(r,i),m=me.parseDeltaAngle(s,l),p=Math.abs(m),j=d;Z(d)&&Z(v)?(ve(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),j="value"):Z(d)&&(ve(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),j=v);var g=n.filter(function(O){return X(O,j,0)!==0}).length,x=(p>=360?g:g-1)*u,_=p-g*f-x,w=n.reduce(function(O,R){var I=X(R,j,0);return O+(P(I)?I:0)},0),A;if(w>0){var $;A=n.map(function(O,R){var I=X(O,j,0),D=X(O,c,R),ue=(P(I)?I:0)/w,K;R?K=$.endAngle+se(m)*u*(I!==0?1:0):K=s;var Ke=K+se(m)*((I!==0?f:0)+ue*_),We=(K+Ke)/2,Ve=(y.innerRadius+y.outerRadius)/2,$t=[{name:D,value:I,payload:O,dataKey:j,type:h}],Rt=Te(y.cx,y.cy,Ve,We);return $=k(k(k({percent:ue,cornerRadius:o,name:D,tooltipPayload:$t,midAngle:We,middleRadius:Ve,tooltipPosition:Rt},O),y),{},{value:X(O,j),startAngle:K,endAngle:Ke,payload:O,paddingAngle:se(m)*u}),$})}return k(k({},y),{},{sectors:A,data:n})});function _t(e,t,i){if(t<1)return[];if(t===1&&i===void 0)return e;for(var r=[],n=0;n<e.length;n+=t)r.push(e[n]);return r}function ui(e,t,i){var r={width:e.width+t.width,height:e.height+t.height};return nr(r,i)}function di(e,t,i){var r=i==="width",n=e.x,o=e.y,s=e.width,l=e.height;return t===1?{start:r?n:o,end:r?n+s:o+l}:{start:r?n+s:o+l,end:r?n:o}}function xe(e,t,i,r,n){if(e*t<e*r||e*t>e*n)return!1;var o=i();return e*(t-e*o/2-r)>=0&&e*(t+e*o/2-n)<=0}function fi(e,t){return _t(e,t+1)}function hi(e,t,i,r,n){for(var o=(r||[]).slice(),s=t.start,l=t.end,u=0,d=1,c=s,v=function(){var y=r?.[u];if(y===void 0)return{v:_t(r,d)};var m=u,p,j=function(){return p===void 0&&(p=i(y,m)),p},g=y.coordinate,x=u===0||xe(e,g,j,c,l);x||(u=0,c=s,d+=1),x&&(c=g+e*(j()/2+n),u+=d)},h;d<=o.length;)if(h=v(),h)return h.v;return[]}function le(e){"@babel/helpers - typeof";return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(e)}function it(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?it(Object(i),!0).forEach(function(r){mi(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):it(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function mi(e,t,i){return t=pi(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function pi(e){var t=vi(e,"string");return le(t)=="symbol"?t:t+""}function vi(e,t){if(le(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(le(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yi(e,t,i,r,n){for(var o=(r||[]).slice(),s=o.length,l=t.start,u=t.end,d=function(h){var f=o[h],y,m=function(){return y===void 0&&(y=i(f,h)),y};if(h===s-1){var p=e*(f.coordinate+e*m()/2-u);o[h]=f=S(S({},f),{},{tickCoord:p>0?f.coordinate-p*e:f.coordinate})}else o[h]=f=S(S({},f),{},{tickCoord:f.coordinate});var j=xe(e,f.tickCoord,m,l,u);j&&(u=f.tickCoord-e*(m()/2+n),o[h]=S(S({},f),{},{isShow:!0}))},c=s-1;c>=0;c--)d(c);return o}function xi(e,t,i,r,n,o){var s=(r||[]).slice(),l=s.length,u=t.start,d=t.end;if(o){var c=r[l-1],v=i(c,l-1),h=e*(c.coordinate+e*v/2-d);s[l-1]=c=S(S({},c),{},{tickCoord:h>0?c.coordinate-h*e:c.coordinate});var f=xe(e,c.tickCoord,function(){return v},u,d);f&&(d=c.tickCoord-e*(v/2+n),s[l-1]=S(S({},c),{},{isShow:!0}))}for(var y=o?l-1:l,m=function(g){var x=s[g],_,w=function(){return _===void 0&&(_=i(x,g)),_};if(g===0){var A=e*(x.coordinate-e*w()/2-u);s[g]=x=S(S({},x),{},{tickCoord:A<0?x.coordinate-A*e:x.coordinate})}else s[g]=x=S(S({},x),{},{tickCoord:x.coordinate});var $=xe(e,x.tickCoord,w,u,d);$&&(u=x.tickCoord+e*(w()/2+n),s[g]=S(S({},x),{},{isShow:!0}))},p=0;p<y;p++)m(p);return s}function Fe(e,t,i){var r=e.tick,n=e.ticks,o=e.viewBox,s=e.minTickGap,l=e.orientation,u=e.interval,d=e.tickFormatter,c=e.unit,v=e.angle;if(!n||!n.length||!r)return[];if(P(u)||ht.isSsr)return fi(n,typeof u=="number"&&P(u)?u:0);var h=[],f=l==="top"||l==="bottom"?"width":"height",y=c&&f==="width"?Ae(c,{fontSize:t,letterSpacing:i}):{width:0,height:0},m=function(x,_){var w=z(d)?d(x.value,_):x.value;return f==="width"?ui(Ae(w,{fontSize:t,letterSpacing:i}),y,v):Ae(w,{fontSize:t,letterSpacing:i})[f]},p=n.length>=2?se(n[1].coordinate-n[0].coordinate):1,j=di(o,p,f);return u==="equidistantPreserveStart"?hi(p,j,m,n,s):(u==="preserveStart"||u==="preserveStartEnd"?h=xi(p,j,m,n,s,u==="preserveStartEnd"):h=yi(p,j,m,n,s),h.filter(function(g){return g.isShow}))}var gi=["viewBox"],bi=["viewBox"],ji=["ticks"];function ee(e){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}function Y(){return Y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Y.apply(this,arguments)}function nt(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function N(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?nt(Object(i),!0).forEach(function(r){Be(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nt(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Pe(e,t){if(e==null)return{};var i=_i(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _i(e,t){if(e==null)return{};var i={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;i[r]=e[r]}return i}function wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kt(r.key),r)}}function ki(e,t,i){return t&&at(e.prototype,t),i&&at(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ai(e,t,i){return t=ge(t),Oi(e,wt()?Reflect.construct(t,i||[],ge(e).constructor):t.apply(e,i))}function Oi(e,t){if(t&&(ee(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ni(e)}function Ni(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wt=function(){return!!e})()}function ge(e){return ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ge(e)}function Pi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$e(e,t)}function $e(e,t){return $e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},$e(e,t)}function Be(e,t,i){return t=kt(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kt(e){var t=Si(e,"string");return ee(t)=="symbol"?t:t+""}function Si(e,t){if(ee(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(ee(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ie=function(e){function t(i){var r;return wi(this,t),r=Ai(this,t,[i]),r.state={fontSize:"",letterSpacing:""},r}return Pi(t,e),ki(t,[{key:"shouldComponentUpdate",value:function(r,n){var o=r.viewBox,s=Pe(r,gi),l=this.props,u=l.viewBox,d=Pe(l,bi);return!Oe(o,u)||!Oe(s,d)||!Oe(n,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var n=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];n&&this.setState({fontSize:window.getComputedStyle(n).fontSize,letterSpacing:window.getComputedStyle(n).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var n=this.props,o=n.x,s=n.y,l=n.width,u=n.height,d=n.orientation,c=n.tickSize,v=n.mirror,h=n.tickMargin,f,y,m,p,j,g,x=v?-1:1,_=r.tickSize||c,w=P(r.tickCoord)?r.tickCoord:r.coordinate;switch(d){case"top":f=y=r.coordinate,p=s+ +!v*u,m=p-x*_,g=m-x*h,j=w;break;case"left":m=p=r.coordinate,y=o+ +!v*l,f=y-x*_,j=f-x*h,g=w;break;case"right":m=p=r.coordinate,y=o+ +v*l,f=y+x*_,j=f+x*h,g=w;break;default:f=y=r.coordinate,p=s+ +v*u,m=p+x*_,g=m+x*h,j=w;break}return{line:{x1:f,y1:m,x2:y,y2:p},tick:{x:j,y:g}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,n=r.orientation,o=r.mirror,s;switch(n){case"left":s=o?"start":"end";break;case"right":s=o?"end":"start";break;default:s="middle";break}return s}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,n=r.orientation,o=r.mirror,s="end";switch(n){case"left":case"right":s="middle";break;case"top":s=o?"start":"end";break;default:s=o?"end":"start";break}return s}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.x,o=r.y,s=r.width,l=r.height,u=r.orientation,d=r.mirror,c=r.axisLine,v=N(N(N({},M(this.props,!1)),M(c,!1)),{},{fill:"none"});if(u==="top"||u==="bottom"){var h=+(u==="top"&&!d||u==="bottom"&&d);v=N(N({},v),{},{x1:n,y1:o+h*l,x2:n+s,y2:o+h*l})}else{var f=+(u==="left"&&!d||u==="right"&&d);v=N(N({},v),{},{x1:n+f*s,y1:o,x2:n+f*s,y2:o+l})}return b.createElement("line",Y({},v,{className:F("recharts-cartesian-axis-line",Ce(c,"className"))}))}},{key:"renderTicks",value:function(r,n,o){var s=this,l=this.props,u=l.tickLine,d=l.stroke,c=l.tick,v=l.tickFormatter,h=l.unit,f=Fe(N(N({},this.props),{},{ticks:r}),n,o),y=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),p=M(this.props,!1),j=M(c,!1),g=N(N({},p),{},{fill:"none"},M(u,!1)),x=f.map(function(_,w){var A=s.getTickLineCoord(_),$=A.line,O=A.tick,R=N(N(N(N({textAnchor:y,verticalAnchor:m},p),{},{stroke:"none",fill:d},j),O),{},{index:w,payload:_,visibleTicksCount:f.length,tickFormatter:v});return b.createElement(G,Y({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},dt(s.props,_,w)),u&&b.createElement("line",Y({},g,$,{className:F("recharts-cartesian-axis-tick-line",Ce(u,"className"))})),c&&t.renderTickItem(c,R,"".concat(z(v)?v(_.value,w):_.value).concat(h||"")))});return b.createElement("g",{className:"recharts-cartesian-axis-ticks"},x)}},{key:"render",value:function(){var r=this,n=this.props,o=n.axisLine,s=n.width,l=n.height,u=n.ticksGenerator,d=n.className,c=n.hide;if(c)return null;var v=this.props,h=v.ticks,f=Pe(v,ji),y=h;return z(u)&&(y=h&&h.length>0?u(this.props):u(f)),s<=0||l<=0||!y||!y.length?null:b.createElement(G,{className:F("recharts-cartesian-axis",d),ref:function(p){r.layerReference=p}},o&&this.renderAxisLine(),this.renderTicks(y,this.state.fontSize,this.state.letterSpacing),ft.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,n,o){var s,l=F(n.className,"recharts-cartesian-axis-tick-value");return b.isValidElement(r)?s=b.cloneElement(r,N(N({},n),{},{className:l})):z(r)?s=r(N(N({},n),{},{className:l})):s=b.createElement(ut,Y({},n,{className:"recharts-cartesian-axis-tick-value"}),o),s}}])}(V.Component);Be(ie,"displayName","CartesianAxis");Be(ie,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var Ti=["x1","y1","x2","y2","key"],Ci=["offset"];function q(e){"@babel/helpers - typeof";return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(e)}function ot(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),i.push.apply(i,r)}return i}function T(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ot(Object(i),!0).forEach(function(r){Ei(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ot(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function Ei(e,t,i){return t=$i(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function $i(e){var t=Ri(e,"string");return q(t)=="symbol"?t:t+""}function Ri(e,t){if(q(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(q(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},H.apply(this,arguments)}function st(e,t){if(e==null)return{};var i=Ii(e,t),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ii(e,t){if(e==null)return{};var i={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;i[r]=e[r]}return i}var zi=function(t){var i=t.fill;if(!i||i==="none")return null;var r=t.fillOpacity,n=t.x,o=t.y,s=t.width,l=t.height,u=t.ry;return b.createElement("rect",{x:n,y:o,ry:u,width:s,height:l,stroke:"none",fill:i,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function At(e,t){var i;if(b.isValidElement(e))i=b.cloneElement(e,t);else if(z(e))i=e(t);else{var r=t.x1,n=t.y1,o=t.x2,s=t.y2,l=t.key,u=st(t,Ti),d=M(u,!1);d.offset;var c=st(d,Ci);i=b.createElement("line",H({},c,{x1:r,y1:n,x2:o,y2:s,fill:"none",key:l}))}return i}function Li(e){var t=e.x,i=e.width,r=e.horizontal,n=r===void 0?!0:r,o=e.horizontalPoints;if(!n||!o||!o.length)return null;var s=o.map(function(l,u){var d=T(T({},e),{},{x1:t,y1:l,x2:t+i,y2:l,key:"line-".concat(u),index:u});return At(n,d)});return b.createElement("g",{className:"recharts-cartesian-grid-horizontal"},s)}function Mi(e){var t=e.y,i=e.height,r=e.vertical,n=r===void 0?!0:r,o=e.verticalPoints;if(!n||!o||!o.length)return null;var s=o.map(function(l,u){var d=T(T({},e),{},{x1:l,y1:t,x2:l,y2:t+i,key:"line-".concat(u),index:u});return At(n,d)});return b.createElement("g",{className:"recharts-cartesian-grid-vertical"},s)}function Di(e){var t=e.horizontalFill,i=e.fillOpacity,r=e.x,n=e.y,o=e.width,s=e.height,l=e.horizontalPoints,u=e.horizontal,d=u===void 0?!0:u;if(!d||!t||!t.length)return null;var c=l.map(function(h){return Math.round(h+n-n)}).sort(function(h,f){return h-f});n!==c[0]&&c.unshift(0);var v=c.map(function(h,f){var y=!c[f+1],m=y?n+s-h:c[f+1]-h;if(m<=0)return null;var p=f%t.length;return b.createElement("rect",{key:"react-".concat(f),y:h,x:r,height:m,width:o,stroke:"none",fill:t[p],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return b.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},v)}function Fi(e){var t=e.vertical,i=t===void 0?!0:t,r=e.verticalFill,n=e.fillOpacity,o=e.x,s=e.y,l=e.width,u=e.height,d=e.verticalPoints;if(!i||!r||!r.length)return null;var c=d.map(function(h){return Math.round(h+o-o)}).sort(function(h,f){return h-f});o!==c[0]&&c.unshift(0);var v=c.map(function(h,f){var y=!c[f+1],m=y?o+l-h:c[f+1]-h;if(m<=0)return null;var p=f%r.length;return b.createElement("rect",{key:"react-".concat(f),x:h,y:s,width:m,height:u,stroke:"none",fill:r[p],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return b.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},v)}var Bi=function(t,i){var r=t.xAxis,n=t.width,o=t.height,s=t.offset;return pt(Fe(T(T(T({},ie.defaultProps),r),{},{ticks:_e(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),s.left,s.left+s.width,i)},Ki=function(t,i){var r=t.yAxis,n=t.width,o=t.height,s=t.offset;return pt(Fe(T(T(T({},ie.defaultProps),r),{},{ticks:_e(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),s.top,s.top+s.height,i)},Q={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Ot(e){var t,i,r,n,o,s,l=Me(),u=De(),d=ar(),c=T(T({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Q.stroke,fill:(i=e.fill)!==null&&i!==void 0?i:Q.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Q.horizontal,horizontalFill:(n=e.horizontalFill)!==null&&n!==void 0?n:Q.horizontalFill,vertical:(o=e.vertical)!==null&&o!==void 0?o:Q.vertical,verticalFill:(s=e.verticalFill)!==null&&s!==void 0?s:Q.verticalFill,x:P(e.x)?e.x:d.left,y:P(e.y)?e.y:d.top,width:P(e.width)?e.width:d.width,height:P(e.height)?e.height:d.height}),v=c.x,h=c.y,f=c.width,y=c.height,m=c.syncWithTicks,p=c.horizontalValues,j=c.verticalValues,g=or(),x=sr();if(!P(f)||f<=0||!P(y)||y<=0||!P(v)||v!==+v||!P(h)||h!==+h)return null;var _=c.verticalCoordinatesGenerator||Bi,w=c.horizontalCoordinatesGenerator||Ki,A=c.horizontalPoints,$=c.verticalPoints;if((!A||!A.length)&&z(w)){var O=p&&p.length,R=w({yAxis:x?T(T({},x),{},{ticks:O?p:x.ticks}):void 0,width:l,height:u,offset:d},O?!0:m);ve(Array.isArray(R),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(q(R),"]")),Array.isArray(R)&&(A=R)}if((!$||!$.length)&&z(_)){var I=j&&j.length,D=_({xAxis:g?T(T({},g),{},{ticks:I?j:g.ticks}):void 0,width:l,height:u,offset:d},I?!0:m);ve(Array.isArray(D),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(q(D),"]")),Array.isArray(D)&&($=D)}return b.createElement("g",{className:"recharts-cartesian-grid"},b.createElement(zi,{fill:c.fill,fillOpacity:c.fillOpacity,x:c.x,y:c.y,width:c.width,height:c.height,ry:c.ry}),b.createElement(Li,H({},c,{offset:d,horizontalPoints:A,xAxis:g,yAxis:x})),b.createElement(Mi,H({},c,{offset:d,verticalPoints:$,xAxis:g,yAxis:x})),b.createElement(Di,H({},c,{horizontalPoints:A})),b.createElement(Fi,H({},c,{verticalPoints:$})))}Ot.displayName="CartesianGrid";function te(e){"@babel/helpers - typeof";return te=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},te(e)}function Wi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vi(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,St(r.key),r)}}function Gi(e,t,i){return t&&Vi(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hi(e,t,i){return t=be(t),qi(e,Nt()?Reflect.construct(t,i||[],be(e).constructor):t.apply(e,i))}function qi(e,t){if(t&&(te(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qi(e)}function Qi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nt=function(){return!!e})()}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},be(e)}function Xi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}function Re(e,t){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Re(e,t)}function Pt(e,t,i){return t=St(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function St(e){var t=Ui(e,"string");return te(t)=="symbol"?t:t+""}function Ui(e,t){if(te(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(te(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Ie(){return Ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Ie.apply(this,arguments)}function Yi(e){var t=e.xAxisId,i=Me(),r=De(),n=cr(t);return n==null?null:V.createElement(ie,Ie({},n,{className:F("recharts-".concat(n.axisType," ").concat(n.axisType),n.className),viewBox:{x:0,y:0,width:i,height:r},ticksGenerator:function(s){return _e(s,!0)}}))}var we=function(e){function t(){return Wi(this,t),Hi(this,t,arguments)}return Xi(t,e),Gi(t,[{key:"render",value:function(){return V.createElement(Yi,this.props)}}])}(V.Component);Pt(we,"displayName","XAxis");Pt(we,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function re(e){"@babel/helpers - typeof";return re=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(e)}function Zi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ji(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Et(r.key),r)}}function en(e,t,i){return t&&Ji(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tn(e,t,i){return t=je(t),rn(e,Tt()?Reflect.construct(t,i||[],je(e).constructor):t.apply(e,i))}function rn(e,t){if(t&&(re(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nn(e)}function nn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tt=function(){return!!e})()}function je(e){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},je(e)}function an(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}function ze(e,t){return ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ze(e,t)}function Ct(e,t,i){return t=Et(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Et(e){var t=on(e,"string");return re(t)=="symbol"?t:t+""}function on(e,t){if(re(e)!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(re(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Le(){return Le=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Le.apply(this,arguments)}var sn=function(t){var i=t.yAxisId,r=Me(),n=De(),o=lr(i);return o==null?null:V.createElement(ie,Le({},o,{className:F("recharts-".concat(o.axisType," ").concat(o.axisType),o.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(l){return _e(l,!0)}}))},ke=function(e){function t(){return Zi(this,t),tn(this,t,arguments)}return an(t,e),en(t,[{key:"render",value:function(){return V.createElement(sn,this.props)}}])}(V.Component);Ct(ke,"displayName","YAxis");Ct(ke,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});var cn=vt({chartName:"BarChart",GraphicalChild:yt,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:we},{axisType:"yAxis",AxisComp:ke}],formatAxisMap:ur}),ln=vt({chartName:"PieChart",GraphicalChild:B,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:dr},{axisType:"radiusAxis",AxisComp:fr}],formatAxisMap:hr,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const un={严重:"#ef5350",高:"#fb923c",中:"#facc15",低:"#4ade80"};function dn({data:e}){if(!e||typeof e=="string")return a.jsx(C,{title:"威胁统计",icon:Ye,children:a.jsx("p",{className:"text-muted-foreground",children:"威胁统计信息不可用。"})});const t=Object.entries(e.type_distribution||{}).map(([r,n])=>({name:r,count:n})),i=Object.entries(e.severity_distribution||{}).map(([r,n])=>({name:r,count:n}));return a.jsx(C,{title:"威胁统计",icon:Ye,children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:"总威胁数"}),a.jsx("p",{className:"text-4xl font-bold text-primary",children:e.total_threats})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-center mb-2",children:"按严重程度分布"}),a.jsx(Qe,{width:"100%",height:200,children:a.jsxs(ln,{children:[a.jsx(B,{data:i,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"count",nameKey:"name",label:({name:r,percent:n})=>`${r} ${(n*100).toFixed(0)}%`,children:i.map(r=>a.jsx(mt,{fill:un[r.name]||"#8884d8"},`cell-${r.name}`))}),a.jsx(Xe,{contentStyle:{background:"hsl(var(--background))",borderColor:"hsl(var(--border))"}})]})})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-center mb-2",children:"按类型分布"}),a.jsx(Qe,{width:"100%",height:300,children:a.jsxs(cn,{data:t,layout:"vertical",children:[a.jsx(Ot,{strokeDasharray:"3 3"}),a.jsx(we,{type:"number"}),a.jsx(ke,{dataKey:"name",type:"category",width:80}),a.jsx(Xe,{contentStyle:{background:"hsl(var(--background))",borderColor:"hsl(var(--border))"}}),a.jsx(yt,{dataKey:"count",fill:"hsl(var(--primary))",barSize:20})]})})]})]})})}new Date().toISOString(),new Date(new Date().getTime()-3600*1e3).toISOString();const fn={model_id:"defender-alpha-007",report_file:"/reports/defender-alpha-007-20250813.json",timestamp:"2025-08-13T13:06:43.123Z",report_data:{executive_summary:{threat_overview:"本次演练模拟了一起针对Web服务和数据库的复合式攻击。攻击者首先利用Web应用中的SQL注入漏洞（CVE-2022-XXXXX的变种）获取初步访问权限和信息，并成功植入WebShell。同时，攻击者还利用了暴露在公网的数据库服务的弱口令。防御代理成功检测到两条攻击路径，并在攻击者造成实质性破坏前阻断了关键行为。",main_findings:["成功识别并阻止了针对'id'参数的SQL注入联合查询（UNION SELECT）攻击。","检测到利用数据库文件函数（INTO OUTFILE）向Web目录写入恶意PHP WebShell的企图并进行了隔离。","发现并告警了从外部IP直接登录MySQL root账户的异常行为，该行为利用了'root/root'弱口令。","在WebShell被用于执行大规模系统命令之前，成功切断了其与C2的回连。"]},risk_assessment:{risk_level:"严重",details:"尽管攻击被成功防御，但暴露出的两个核心漏洞——Web层SQL注入和数据层弱口令，表明系统存在基础安全架构的严重缺陷。任何一个漏洞被成功利用，都可能导致服务器完全沦陷、数据被窃取或篡改，对业务造成灾难性影响。"},threat_statistics:{total_threats:215,type_distribution:{SQL注入:155,恶意文件上传:10,远程命令执行:25,数据库弱口令访问:5,敏感文件读取:20},severity_distribution:{严重:35,高:90,中:85,低:5}},attack_chain_analysis:{attack_path:"外部侦察 -> 利用Web应用SQL注入 -> 读取敏感文件/信息搜集 -> 植入WebShell后门 -> 尝试执行系统命令。并行路径: 外部侦察 -> 直接利用数据库弱口令登录 -> 完全控制数据库",attack_stages:["初始访问","执行","持久化","凭证访问","发现","收集","命令与控制"],attack_techniques:["利用面向公众应用的漏洞 (T1190)","有效账户: 默认账户 (T1078.001)","服务器软件组件: WebShell (T1505.003)","命令和脚本解释器: Unix Shell (T1059.004)","从信息库中窃取数据 (T1213)"]},attack_types:{SQL注入:{description:"攻击者通过Web应用的'id'参数注入恶意的SQL联合查询语句，以窃取数据库元数据、读取服务器文件并最终写入后门程序。",examples:["/?id=1' union select 1,version() --","/?id=1' union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()--","/?id=1' union select 1,'<?php system($_GET[\\'cmd\\']); ?>' into outfile '/var/www/html/shell.php'--"]},数据库弱口令:{description:"攻击者直接通过公网IP连接到MySQL数据库服务（端口3306），并使用默认的、极易被猜解的'root/root'凭证成功登录，获取了数据库的最高管理权限。",examples:["mysql -h 127.0.0.1 -P 3306 -u root -proot"]}},threat_blocking_analysis:{blocked_ips:["192.0.2.101"],blocked_ports:["3306"],firewall_rules:["DROP in:eth0 out:any src:192.0.2.101 sport:any dst:any dport:8080 proto:tcp -m string --string 'union select' --algo bm -j LOG_AND_DROP","REJECT in:eth0 out:any src:any sport:any dst:any dport:3306 proto:tcp"],blocking_effectiveness:"100% 的已知攻击行为被成功阻断。SQL注入在利用阶段被WAF规则拦截，弱口令登录被网络访问控制策略阻止。"},vulnerability_remediation_analysis:{restarted_services:["apache2","mysql"],web_config_changes:["在PHP应用层面对id参数的获取进行了重构，强制使用参数化查询（PDO）。","修改了PHP配置文件php.ini，禁用了'system', 'exec'等高危函数。"],applied_patches:[],remediation_success_rate:"100%",remediation_actions:["已从/var/www/html/目录中清理了攻击者上传的'shell.php'文件。","已重置MySQL的root账户密码，并配置其只允许本地（localhost）登录。","已为Web应用创建了专用的低权限数据库用户。"]},attribution_summary:{attacker_attribution:"归属于特定APT组织的可能性低。攻击手法为广为人知的经典技术，更符合机会主义攻击者或脚本小子（Script Kiddie）的行为模式。",attack_motivation:"主要动机推测为获取服务器控制权，可能用于后续的挖矿、DDoS僵尸网络或作为进一步攻击的跳板。",attack_impact:"由于防御代理和策略的有效介入，实际影响被限制在极小范围内，未造成数据泄露和业务中断。",attribution_confidence:"低",attribution_reasoning:"攻击中使用的TTPs非常普遍，缺乏独特性和高级技巧，是各类安全教程和自动化工具中的常见payload，不具备指向性。"},response_effectiveness:{effectiveness:"非常有效",details:"防御系统在攻击的初始访问阶段即发出告警，并在持久化（写入WebShell）的关键节点进行了实时阻断。数据库弱口令登录行为也被访问控制策略成功拦截，防止了第二攻击路径的形成。"},emergency_response_plan:{immediate_actions:["隔离受影响的Web服务器容器。","在边界防火墙上阻止攻击源IP。","分析Web和数据库日志以确认攻击的全部范围。"],short_term_measures:["对所有代码库进行安全审计，排查是否存在类似的SQL注入漏洞。","对所有数据库实例进行安全基线检查，确保无弱口令、未授权访问等问题。","审查网络访问控制策略，收紧不必要的服务端口暴露。"],long_term_improvements:["建立强制性的安全编码规范，并将参数化查询作为标准开发实践。","实施定期的自动化安全扫描和渗透测试。","将数据库等核心服务置于内网，不直接对公网暴露。"],personnel_assignments:["应用开发团队: 负责源代码层面的漏洞修复。","系统运维团队: 负责数据库密码和网络访问策略的加固。"],communication_mechanisms:["通过内部工单系统跟踪漏洞修复进度。","在安全周会上向所有技术人员通报此次事件的经验教训。"]},security_recommendations:{recommendations:["**最高优先级**: 立即在代码层面修复SQL注入漏洞，对所有用户输入进行严格的参数化处理。","**最高优先级**: 立即修改MySQL root弱口令，并配置网络ACL，禁止数据库端口对公网暴露。","**中优先级**: 为Web应用配置专用的、权限最小化的数据库账户。","**低优先级**: 部署文件完整性监控系统，对Web目录下的任何文件变更进行实时告警。"]},next_steps:{steps:["完成本次演练的全面复盘，将防御SQL注入和弱口令的最佳实践更新到公司安全知识库。","安排一次针对开发人员的安全编码专项培训。","验证所有修复措施是否已正确部署并生效。"]}}};function Pn(){const e=fn;return a.jsxs(zt,{children:[a.jsxs(Lt,{fixed:!0,children:[a.jsx(Mt,{}),a.jsxs("div",{className:"ml-auto flex items-center space-x-4",children:[a.jsx(Dt,{}),a.jsx(Ft,{})]})]}),a.jsx(Bt,{children:a.jsx("div",{className:"bg-background text-foreground min-h-screen font-sans",children:a.jsx("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8",children:a.jsxs("main",{className:"space-y-8",children:[a.jsx(Jr,{modelId:e.model_id,timestamp:e.timestamp,reportFile:e.report_file}),a.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-3",children:[a.jsxs("div",{className:"space-y-8 lg:col-span-2",children:[a.jsx(Xr,{data:e.report_data.executive_summary}),a.jsx(qr,{data:e.report_data.attack_chain_analysis}),a.jsx(ri,{attackTypes:e.report_data.attack_types,threatBlocking:e.report_data.threat_blocking_analysis}),a.jsx(Zr,{data:e.report_data.vulnerability_remediation_analysis}),a.jsx(Qr,{data:e.report_data.attribution_summary})]}),a.jsxs("aside",{className:"space-y-8 self-start lg:sticky lg:top-8",children:[a.jsx(ti,{data:e.report_data.risk_assessment}),a.jsx(dn,{data:e.report_data.threat_statistics}),a.jsx(ei,{data:e.report_data.response_effectiveness})]})]}),a.jsx(Ur,{emergencyPlan:e.report_data.emergency_response_plan,recommendations:e.report_data.security_recommendations,nextSteps:e.report_data.next_steps})]})})})})]})}export{Pn as S};
